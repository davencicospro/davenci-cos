<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªØ°Ø§ÙƒØ±ÙŠ</title>
</head>

<body>

<h2>ðŸŽ« ØªØ°Ø§ÙƒØ±ÙŠ</h2>
<div id="tickets"></div>

<script type="module">
import { db, auth } from "./firebase.js";
import { collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const container = document.getElementById("tickets");

onAuthStateChanged(auth, async (user) => {
  if (!user) {
    container.innerHTML = "âŒ Ù„Ø§Ø²Ù… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„";
    return;
  }

  const q = query(
    collection(db, "tickets"),
    where("uid", "==", user.uid)
  );

  const snap = await getDocs(q);

  if (snap.empty) {
    container.innerHTML = "Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ°Ø§ÙƒØ±";
    return;
  }

  snap.forEach(doc => {
    const d = doc.data();
    const div = document.createElement("div");
    div.style.border = "1px solid #ccc";
    div.style.margin = "10px";
    div.style.padding = "10px";

    div.innerHTML = `
      <p><strong>Ø§Ù„Ù…Ø´ÙƒÙ„:</strong> ${d.text}</p>
      <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${d.status}</p>
    `;
    container.appendChild(div);
  });
});
</script>

</body>
</html>
